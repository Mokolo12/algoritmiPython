from random import randint
from math import sqrt
import time


def get_median(lst):
    for i in range(n):
        lst.pop(lst.index(min(lst)))

    return min(lst)


def shell_sort(lst, d):
    for i in range(len(lst)):
        while True:
            is_move = False
            for j in range(i, len(lst), d):
                if j + d < len(lst) and lst[j] > lst[j + d]:
                    lst[j], lst[j + d] = lst[j + d], lst[j]
                    is_move = True

            if not is_move:
                break

    if d == 1:
        return
    else:
        d = int(sqrt(d))
        shell_sort(lst, d)


n = randint(10, 1000)
print(f'n = {n}')
lst = [randint(0, 1000) for _ in range(n * 2 + 1)]
print('lst без сортировки', lst)
lst1 = lst[:]
lst2 = lst[:]
print('Отсортированный lst', sorted(lst))
median = get_median(lst[:])
print(f'Медиана без сортировки = {median}')

# В качестве значения d для алгоритма Шелла взял квадратный корень от числа n
# Для каждой следующей итерации использую квадратный корень от d
# Результаты замеров ниже
t1 = time.time()
shell_sort(lst1, int(sqrt(n)))
print(f'Время выполнения сортировки Шелла: {time.time() - t1}')
median = lst1[n]
print(f'Медиана при сортировке Шелла = {median}')

t1 = time.time()
shell_sort(lst2, 1)
print(f'Время выполнения сортировки перестановкой (d = 1): {time.time()- t1}')
median = lst2[n]
print(f'Медиана при сортировке перестановкой = {median}')

"""
n = 741
lst без сортировки [652, 187, 20, 984, 728, 178, 252, 51, 437, 674, 30, 655, 893, 47, 943, 125, 72, 823, 774, 265, 849, 215, 268, 339, 628, 943, 384, 934, 413, 278, 192, 626, 753, 401, 614, 344, 40, 748, 485, 782, 271, 475, 294, 474, 654, 992, 344, 200, 378, 59, 266, 744, 450, 738, 844, 680, 422, 926, 92, 826, 458, 855, 288, 156, 962, 427, 352, 402, 172, 594, 565, 609, 673, 80, 551, 928, 807, 885, 873, 571, 171, 74, 633, 219, 614, 940, 545, 192, 503, 109, 905, 153, 989, 493, 893, 636, 711, 199, 130, 414, 698, 624, 94, 768, 405, 691, 942, 653, 136, 732, 90, 409, 131, 172, 198, 571, 573, 917, 506, 519, 228, 49, 996, 287, 209, 951, 863, 830, 634, 427, 275, 346, 856, 756, 873, 206, 545, 38, 732, 808, 561, 527, 436, 332, 15, 107, 19, 687, 53, 950, 448, 583, 300, 555, 779, 625, 839, 141, 827, 126, 256, 831, 82, 769, 542, 599, 943, 798, 266, 570, 82, 205, 768, 955, 426, 954, 711, 451, 718, 935, 238, 289, 238, 559, 166, 87, 783, 191, 413, 496, 662, 43, 553, 438, 83, 861, 269, 900, 183, 245, 445, 641, 94, 334, 767, 416, 53, 830, 870, 557, 392, 756, 193, 932, 218, 170, 411, 590, 244, 569, 792, 615, 828, 495, 442, 496, 553, 229, 334, 263, 599, 694, 197, 829, 262, 214, 639, 958, 279, 650, 150, 477, 906, 608, 102, 974, 968, 782, 5, 265, 231, 420, 687, 812, 53, 98, 992, 440, 827, 993, 188, 411, 207, 944, 997, 43, 599, 98, 423, 292, 109, 168, 27, 808, 810, 557, 19, 715, 910, 629, 477, 52, 434, 989, 396, 114, 185, 705, 20, 487, 15, 883, 686, 49, 851, 187, 88, 603, 38, 601, 828, 350, 523, 397, 44, 988, 663, 799, 393, 693, 951, 598, 906, 330, 795, 357, 815, 319, 581, 476, 391, 23, 381, 965, 844, 974, 941, 275, 379, 509, 799, 360, 573, 467, 130, 818, 699, 799, 768, 477, 147, 125, 291, 3, 309, 577, 319, 832, 96, 86, 438, 317, 585, 230, 633, 631, 619, 929, 577, 633, 152, 878, 985, 166, 129, 366, 885, 923, 216, 688, 688, 12, 528, 897, 394, 774, 966, 604, 917, 109, 778, 853, 665, 704, 522, 795, 422, 139, 662, 58, 915, 441, 831, 686, 623, 443, 232, 588, 399, 990, 206, 111, 363, 519, 194, 97, 592, 594, 206, 419, 957, 358, 428, 782, 641, 127, 766, 855, 298, 173, 976, 414, 129, 10, 864, 39, 493, 419, 654, 122, 717, 382, 496, 1, 613, 942, 714, 182, 433, 825, 69, 329, 727, 689, 194, 680, 503, 200, 366, 592, 563, 621, 53, 508, 311, 275, 647, 375, 826, 199, 884, 87, 733, 728, 816, 902, 783, 532, 278, 795, 542, 913, 439, 204, 119, 274, 658, 607, 893, 597, 919, 662, 891, 168, 791, 633, 173, 27, 585, 364, 885, 898, 374, 733, 877, 45, 647, 51, 817, 629, 102, 600, 33, 319, 507, 355, 232, 255, 668, 846, 925, 405, 641, 321, 595, 786, 529, 170, 207, 852, 279, 732, 925, 929, 833, 414, 215, 409, 309, 493, 22, 528, 384, 662, 432, 977, 507, 128, 203, 382, 988, 111, 934, 129, 250, 285, 695, 614, 762, 244, 620, 198, 449, 384, 928, 288, 395, 935, 864, 237, 890, 675, 538, 8, 707, 654, 604, 851, 66, 815, 914, 876, 754, 680, 541, 508, 652, 875, 970, 551, 898, 435, 293, 638, 887, 714, 301, 912, 286, 612, 316, 405, 103, 589, 159, 442, 22, 603, 726, 892, 733, 138, 879, 700, 322, 681, 108, 875, 588, 580, 860, 1000, 458, 571, 889, 998, 278, 542, 964, 564, 265, 195, 806, 358, 417, 378, 931, 942, 651, 901, 429, 30, 183, 221, 901, 69, 79, 881, 750, 207, 410, 72, 802, 214, 581, 366, 5, 971, 683, 400, 208, 710, 123, 506, 257, 901, 553, 602, 953, 931, 878, 928, 271, 389, 450, 520, 285, 197, 806, 19, 280, 782, 813, 844, 235, 639, 615, 303, 714, 48, 52, 877, 152, 191, 108, 151, 721, 463, 646, 317, 919, 192, 769, 589, 167, 30, 962, 210, 812, 467, 41, 975, 857, 65, 684, 103, 331, 377, 723, 597, 385, 867, 623, 373, 614, 878, 648, 701, 437, 998, 81, 32, 46, 282, 459, 653, 391, 178, 807, 789, 960, 720, 707, 818, 123, 79, 320, 360, 569, 479, 170, 601, 541, 661, 17, 107, 748, 360, 218, 45, 529, 245, 469, 29, 342, 508, 424, 146, 780, 731, 305, 66, 528, 466, 841, 885, 168, 237, 574, 105, 284, 70, 738, 934, 636, 116, 344, 872, 360, 596, 366, 989, 566, 454, 193, 315, 965, 874, 487, 795, 639, 570, 204, 615, 611, 207, 575, 563, 582, 252, 214, 614, 292, 637, 49, 520, 938, 959, 292, 336, 530, 783, 589, 124, 519, 585, 157, 665, 110, 652, 773, 923, 272, 679, 466, 85, 472, 710, 109, 20, 447, 477, 208, 210, 430, 448, 157, 151, 926, 81, 304, 377, 773, 623, 228, 709, 322, 280, 823, 828, 942, 104, 908, 701, 307, 755, 427, 648, 856, 768, 974, 33, 81, 161, 488, 145, 786, 59, 357, 333, 814, 947, 549, 237, 673, 75, 959, 167, 404, 585, 80, 419, 204, 45, 610, 8, 485, 973, 75, 707, 483, 710, 867, 748, 77, 267, 979, 809, 88, 982, 707, 263, 731, 319, 82, 816, 810, 651, 802, 636, 594, 151, 611, 484, 50, 322, 258, 125, 562, 702, 18, 892, 442, 353, 240, 453, 483, 463, 148, 330, 433, 536, 592, 64, 624, 593, 493, 652, 218, 250, 102, 831, 604, 346, 750, 700, 77, 442, 828, 131, 411, 181, 274, 577, 418, 752, 331, 372, 410, 692, 425, 464, 249, 656, 509, 232, 383, 696, 49, 252, 773, 227, 290, 588, 777, 588, 785, 596, 940, 953, 792, 408, 712, 247, 13, 668, 219, 694, 838, 253, 679, 25, 378, 415, 238, 629, 641, 191, 140, 718, 699, 502, 353, 602, 280, 1, 167, 60, 158, 920, 823, 62, 892, 832, 491, 201, 499, 62, 245, 564, 560, 616, 148, 300, 655, 541, 571, 182, 328, 993, 872, 733, 18, 239, 97, 19, 126, 931, 524, 52, 689, 659, 46, 783, 298, 248, 674, 291, 156, 547, 756, 811, 781, 972, 77, 641, 201, 82, 121, 564, 557, 841, 309, 89, 85, 780, 418, 234, 355, 616, 55, 276, 336, 909, 103, 147, 514, 235, 361, 196, 174, 277, 691, 403, 604, 570, 70, 947, 498, 270, 9, 972, 618, 776, 230, 817, 603, 79, 504, 695, 163, 777, 278, 679, 988, 159, 197, 671, 386, 234, 135, 256, 972, 759, 978, 811, 578, 962, 388, 322, 520, 572, 34, 393, 840, 417, 586, 551, 260, 175, 846, 204, 367, 267, 811, 375, 335, 392, 603, 450, 192, 577, 121, 492, 725, 861, 784, 92, 582, 955, 615, 643, 32, 218, 950, 554, 968, 131, 587, 568, 273, 975, 232, 344, 294, 838, 84, 300, 748, 830, 992, 612, 999, 646, 931, 693, 696, 915, 664, 976, 546, 520, 145, 792, 148, 498, 107, 617, 25, 962, 537, 264, 391, 892, 495, 313, 29, 157, 807, 355, 512, 703, 937, 403, 312, 847, 908, 778, 481, 709, 987, 220, 156, 269, 852, 406, 848, 870, 770, 601, 937, 571, 409, 305, 524, 448, 435, 82, 292, 177, 914, 111, 527, 955, 969, 810, 5, 504, 990, 3, 198, 860, 695, 668, 764, 170, 253, 1000, 128, 62, 823, 538, 945, 706, 795, 99, 63, 274, 903, 897, 363, 700, 8, 846, 721, 866, 386, 662, 699, 493, 443, 669, 277, 890, 377, 301, 266, 692, 115, 517, 58, 924, 529, 464, 976, 523, 971, 499, 493, 745, 948, 82, 22, 830, 232, 962, 825, 797, 708, 623, 22, 451, 657, 113, 460, 879, 840, 379, 497, 471, 422, 259, 602, 835, 226, 541, 660, 151, 840, 677, 273, 624, 343, 666, 116, 834, 389, 499, 981, 917, 963, 586, 763, 145, 27, 986, 534, 729, 738, 285, 978, 91, 283, 863, 147, 477, 336, 944, 472, 984, 439, 998, 462, 706, 284, 410, 776, 980, 877, 215, 397, 178, 753, 805, 232, 252, 728, 452, 154, 496, 216, 154, 427, 301, 951, 227, 714, 609, 946, 506, 145, 142, 483, 265, 197, 633, 116, 675, 720, 850, 141, 879, 124, 797, 212, 545, 119, 753, 326, 651, 750, 791, 213, 161, 160, 4, 386, 691, 257, 82, 755, 290, 82, 644, 898, 533, 153, 654, 652, 145, 867, 578, 577, 605, 193, 977, 87, 727, 295, 536, 940, 378, 278, 92, 228, 528, 839, 874, 736, 486, 302, 344, 1000, 280, 212, 67, 836, 809, 86, 627, 766, 385, 758, 773, 678, 688, 593, 427, 34, 451, 942, 557, 908, 257, 781, 961, 968, 806, 627, 892, 88, 524, 381, 623, 453, 102, 308, 972, 974, 644, 81, 249, 327]
Отсортированный lst [1, 1, 3, 3, 4, 5, 5, 5, 8, 8, 8, 9, 10, 12, 13, 15, 15, 17, 18, 18, 19, 19, 19, 19, 20, 20, 20, 22, 22, 22, 22, 23, 25, 25, 27, 27, 27, 29, 29, 30, 30, 30, 32, 32, 33, 33, 34, 34, 38, 38, 39, 40, 41, 43, 43, 44, 45, 45, 45, 46, 46, 47, 48, 49, 49, 49, 49, 50, 51, 51, 52, 52, 52, 53, 53, 53, 53, 55, 58, 58, 59, 59, 60, 62, 62, 62, 63, 64, 65, 66, 66, 67, 69, 69, 70, 70, 72, 72, 74, 75, 75, 77, 77, 77, 79, 79, 79, 80, 80, 81, 81, 81, 81, 82, 82, 82, 82, 82, 82, 82, 82, 83, 84, 85, 85, 86, 86, 87, 87, 87, 88, 88, 88, 89, 90, 91, 92, 92, 92, 94, 94, 96, 97, 97, 98, 98, 99, 102, 102, 102, 102, 103, 103, 103, 104, 105, 107, 107, 107, 108, 108, 109, 109, 109, 109, 110, 111, 111, 111, 113, 114, 115, 116, 116, 116, 119, 119, 121, 121, 122, 123, 123, 124, 124, 125, 125, 125, 126, 126, 127, 128, 128, 129, 129, 129, 130, 130, 131, 131, 131, 135, 136, 138, 139, 140, 141, 141, 142, 145, 145, 145, 145, 145, 146, 147, 147, 147, 148, 148, 148, 150, 151, 151, 151, 151, 152, 152, 153, 153, 154, 154, 156, 156, 156, 157, 157, 157, 158, 159, 159, 160, 161, 161, 163, 166, 166, 167, 167, 167, 168, 168, 168, 170, 170, 170, 170, 171, 172, 172, 173, 173, 174, 175, 177, 178, 178, 178, 181, 182, 182, 183, 183, 185, 187, 187, 188, 191, 191, 191, 192, 192, 192, 192, 193, 193, 193, 194, 194, 195, 196, 197, 197, 197, 197, 198, 198, 198, 199, 199, 200, 200, 201, 201, 203, 204, 204, 204, 204, 205, 206, 206, 206, 207, 207, 207, 207, 208, 208, 209, 210, 210, 212, 212, 213, 214, 214, 214, 215, 215, 215, 216, 216, 218, 218, 218, 218, 219, 219, 220, 221, 226, 227, 227, 228, 228, 228, 229, 230, 230, 231, 232, 232, 232, 232, 232, 232, 234, 234, 235, 235, 237, 237, 237, 238, 238, 238, 239, 240, 244, 244, 245, 245, 245, 247, 248, 249, 249, 250, 250, 252, 252, 252, 252, 253, 253, 255, 256, 256, 257, 257, 257, 258, 259, 260, 262, 263, 263, 264, 265, 265, 265, 265, 266, 266, 266, 267, 267, 268, 269, 269, 270, 271, 271, 272, 273, 273, 274, 274, 274, 275, 275, 275, 276, 277, 277, 278, 278, 278, 278, 278, 279, 279, 280, 280, 280, 280, 282, 283, 284, 284, 285, 285, 285, 286, 287, 288, 288, 289, 290, 290, 291, 291, 292, 292, 292, 292, 293, 294, 294, 295, 298, 298, 300, 300, 300, 301, 301, 301, 302, 303, 304, 305, 305, 307, 308, 309, 309, 309, 311, 312, 313, 315, 316, 317, 317, 319, 319, 319, 319, 320, 321, 322, 322, 322, 322, 326, 327, 328, 329, 330, 330, 331, 331, 332, 333, 334, 334, 335, 336, 336, 336, 339, 342, 343, 344, 344, 344, 344, 344, 346, 346, 350, 352, 353, 353, 355, 355, 355, 357, 357, 358, 358, 360, 360, 360, 360, 361, 363, 363, 364, 366, 366, 366, 366, 367, 372, 373, 374, 375, 375, 377, 377, 377, 378, 378, 378, 378, 379, 379, 381, 381, 382, 382, 383, 384, 384, 384, 385, 385, 386, 386, 386, 388, 389, 389, 391, 391, 391, 392, 392, 393, 393, 394, 395, 396, 397, 397, 399, 400, 401, 402, 403, 403, 404, 405, 405, 405, 406, 408, 409, 409, 409, 410, 410, 410, 411, 411, 411, 413, 413, 414, 414, 414, 415, 416, 417, 417, 418, 418, 419, 419, 419, 420, 422, 422, 422, 423, 424, 425, 426, 427, 427, 427, 427, 427, 428, 429, 430, 432, 433, 433, 434, 435, 435, 436, 437, 437, 438, 438, 439, 439, 440, 441, 442, 442, 442, 442, 443, 443, 445, 447, 448, 448, 448, 449, 450, 450, 450, 451, 451, 451, 452, 453, 453, 454, 458, 458, 459, 460, 462, 463, 463, 464, 464, 466, 466, 467, 467, 469, 471, 472, 472, 474, 475, 476, 477, 477, 477, 477, 477, 479, 481, 483, 483, 483, 484, 485, 485, 486, 487, 487, 488, 491, 492, 493, 493, 493, 493, 493, 493, 495, 495, 496, 496, 496, 496, 497, 498, 498, 499, 499, 499, 502, 503, 503, 504, 504, 506, 506, 506, 507, 507, 508, 508, 508, 509, 509, 512, 514, 517, 519, 519, 519, 520, 520, 520, 520, 522, 523, 523, 524, 524, 524, 527, 527, 528, 528, 528, 528, 529, 529, 529, 530, 532, 533, 534, 536, 536, 537, 538, 538, 541, 541, 541, 541, 542, 542, 542, 545, 545, 545, 546, 547, 549, 551, 551, 551, 553, 553, 553, 554, 555, 557, 557, 557, 557, 559, 560, 561, 562, 563, 563, 564, 564, 564, 565, 566, 568, 569, 569, 570, 570, 570, 571, 571, 571, 571, 571, 572, 573, 573, 574, 575, 577, 577, 577, 577, 577, 578, 578, 580, 581, 581, 582, 582, 583, 585, 585, 585, 585, 586, 586, 587, 588, 588, 588, 588, 589, 589, 589, 590, 592, 592, 592, 593, 593, 594, 594, 594, 595, 596, 596, 597, 597, 598, 599, 599, 599, 600, 601, 601, 601, 602, 602, 602, 603, 603, 603, 603, 604, 604, 604, 604, 605, 607, 608, 609, 609, 610, 611, 611, 612, 612, 613, 614, 614, 614, 614, 614, 615, 615, 615, 615, 616, 616, 617, 618, 619, 620, 621, 623, 623, 623, 623, 623, 624, 624, 624, 625, 626, 627, 627, 628, 629, 629, 629, 631, 633, 633, 633, 633, 633, 634, 636, 636, 636, 637, 638, 639, 639, 639, 641, 641, 641, 641, 641, 643, 644, 644, 646, 646, 647, 647, 648, 648, 650, 651, 651, 651, 652, 652, 652, 652, 652, 653, 653, 654, 654, 654, 654, 655, 655, 656, 657, 658, 659, 660, 661, 662, 662, 662, 662, 662, 663, 664, 665, 665, 666, 668, 668, 668, 669, 671, 673, 673, 674, 674, 675, 675, 677, 678, 679, 679, 679, 680, 680, 680, 681, 683, 684, 686, 686, 687, 687, 688, 688, 688, 689, 689, 691, 691, 691, 692, 692, 693, 693, 694, 694, 695, 695, 695, 696, 696, 698, 699, 699, 699, 700, 700, 700, 701, 701, 702, 703, 704, 705, 706, 706, 707, 707, 707, 707, 708, 709, 709, 710, 710, 710, 711, 711, 712, 714, 714, 714, 714, 715, 717, 718, 718, 720, 720, 721, 721, 723, 725, 726, 727, 727, 728, 728, 728, 729, 731, 731, 732, 732, 732, 733, 733, 733, 733, 736, 738, 738, 738, 744, 745, 748, 748, 748, 748, 750, 750, 750, 752, 753, 753, 753, 754, 755, 755, 756, 756, 756, 758, 759, 762, 763, 764, 766, 766, 767, 768, 768, 768, 768, 769, 769, 770, 773, 773, 773, 773, 774, 774, 776, 776, 777, 777, 778, 778, 779, 780, 780, 781, 781, 782, 782, 782, 782, 783, 783, 783, 783, 784, 785, 786, 786, 789, 791, 791, 792, 792, 792, 795, 795, 795, 795, 795, 797, 797, 798, 799, 799, 799, 802, 802, 805, 806, 806, 806, 807, 807, 807, 808, 808, 809, 809, 810, 810, 810, 811, 811, 811, 812, 812, 813, 814, 815, 815, 816, 816, 817, 817, 818, 818, 823, 823, 823, 823, 825, 825, 826, 826, 827, 827, 828, 828, 828, 828, 829, 830, 830, 830, 830, 831, 831, 831, 832, 832, 833, 834, 835, 836, 838, 838, 839, 839, 840, 840, 840, 841, 841, 844, 844, 844, 846, 846, 846, 847, 848, 849, 850, 851, 851, 852, 852, 853, 855, 855, 856, 856, 857, 860, 860, 861, 861, 863, 863, 864, 864, 866, 867, 867, 867, 870, 870, 872, 872, 873, 873, 874, 874, 875, 875, 876, 877, 877, 877, 878, 878, 878, 879, 879, 879, 881, 883, 884, 885, 885, 885, 885, 887, 889, 890, 890, 891, 892, 892, 892, 892, 892, 893, 893, 893, 897, 897, 898, 898, 898, 900, 901, 901, 901, 902, 903, 905, 906, 906, 908, 908, 908, 909, 910, 912, 913, 914, 914, 915, 915, 917, 917, 917, 919, 919, 920, 923, 923, 924, 925, 925, 926, 926, 928, 928, 928, 929, 929, 931, 931, 931, 931, 932, 934, 934, 934, 935, 935, 937, 937, 938, 940, 940, 940, 941, 942, 942, 942, 942, 942, 943, 943, 943, 944, 944, 945, 946, 947, 947, 948, 950, 950, 951, 951, 951, 953, 953, 954, 955, 955, 955, 957, 958, 959, 959, 960, 961, 962, 962, 962, 962, 962, 963, 964, 965, 965, 966, 968, 968, 968, 969, 970, 971, 971, 972, 972, 972, 972, 973, 974, 974, 974, 974, 975, 975, 976, 976, 976, 977, 977, 978, 978, 979, 980, 981, 982, 984, 984, 985, 986, 987, 988, 988, 988, 989, 989, 989, 990, 990, 992, 992, 992, 993, 993, 996, 997, 998, 998, 998, 999, 1000, 1000, 1000]
Медиана без сортировки = 507
Время выполнения сортировки Шелла: 0.298602819442749
Медиана при сортировке Шелла = 507
Время выполнения сортировки перестановкой (d = 1): 0.49491024017333984
Медиана при сортировке перестановкой = 507

Process finished with exit code 0
"""
